# 一、CPU组成

ALU（算术逻辑运算单元）：负责指令执行（完成操作码所要做的运算）

控制器：负责取值、译码、取数、存数等非执行操作

寄存器组：

​	有些是必须：

​			PC（Program Courter 程序计数器）：指示CPU后面要执行的指令在内存中的位置，内存地址值     

​			PSR（程序状态寄存器）：记录一些程序执行的当前状态

​    有些寄存器是CPU厂商根据他们的设计来决定有否或有多少，其中大部分都是通用寄存器



两种设计思想：

RISC: Reduced Instruction Set Computer   精简指令集计算机：ALU中只集成比较少的、基础的、必须的运算电路，学起来容易、制造也相对简单，功耗比较小，执行复杂程序的速度较慢（同样CPU频率下）

CISC: Complex Instruction Set Computer   复杂指令集计算机：ALU中集成尽量多的运算电路来提升功能，学起来较难、制造较难、功耗比较大，执行复杂程序的速度较快（同样CPU频率下）



# 二、CPU与内存的连接(存储器结构)

CPU与内存主要通过数据总线和地址总线相连：

数据总线：负责传输内存中存放的内容，其根数，实际就是CPU的字

地址总线：负责访问内存的起始位置（地址值），其根数决定CPU支持的最大内存容量



冯.偌伊曼结构：用一组总线来传输数据和指令

![冯偌伊曼结构](.\冯偌伊曼结构.jpg)

哈佛结构：用两组总线，一组负责传输数据，另一组负责传输指令

![哈佛结构](.\哈佛结构.jpg)

# 三、各种处理器

微处理器MPU： Micro Processor Unit，采用大规模集成电路技术制作的处理器

1. 通用微处理器：可以运行功能不同的程序

​	微控制器MCU： Micro Controller Unit  单片微型计算机(Single Chip Micro-Computer)  单片机

​					一台计算机的核心部件和常用的外设控制部件都集成在一颗芯片上

​					不运行操作系统或运行一些简易的操作系统

​	片上系统SOC： System On Chip  功能更加强大的MCU

​					一台计算机的核心部件和常用的外设控制部件都集成在一颗芯片上

​					可以运行复杂操作系统

​	PC机微处理器

2. 专用微处理器：只能运行一些指定功能的算法指令，一般作为一台计算机的辅助处理装置

​	数字信号处理器DSP： Digital Signal Processor   

​	图形处理器GPU： Graphics Processing Unit

​	音频处理器APU： Audio Processing Unit

​    。。。。。

# 四、流水线技术

三级流水线技术

![流水线](.\流水线.jpg)

五级流水线

六、八流水线

流水线技术并不是始终有效的：

1. 后一条指令需要使用前一条指令的运算结果
2. 跳转时

# 五、ARM简介

Advanced RISC Machines

公司名：ARM，不生产CPU，只提供设计制造CPU的技术

技术专利：ARM

系列处理器：ARM系列的CPU

半导体芯片行业的运作模式：

1. IDM： Integrated Device Manufacture 三星、德州仪器（TI）

2. Foundry：代工厂 台积电TSMC  中芯国际SMIC  

3. Fabless：无工厂芯片供应商 、设计公司

   海思、联发科（MTK）、博通（Broadcom）

![ARM合作伙伴](.\ARM合作伙伴.jpg)



# 六、ARM体系结构的版本

CPU体系结构：指令集、工作模式

根据需求基于同种体系结构可以有多种处理器

V1、V2、V3：

V4：ARM7系列（三级流水线、冯偌伊曼结构）、ARM9系列（五级流水线、哈佛结构）、StrongARM（Intel）

V5：ARM9E系列、ARM10系列、ARM10E系列、 Xscale（Intel）

V6：ARM11系列

V7：

​	Cortex-A ：Application A5、A8、A9、A15、A53   A73    Exynos（三星） 要能运行多个应用程序的场合（运行复杂操作系统的场合）

​	Cortex-M：MCU  M0、M3、M4   STM32    单片机

​	Cortex-R：Realtime   实时性要求比较高的场合    R4

V8：支持64位处理

# 七、基于ARM处理器的汇编

两套指令与两种工作状态：

1. ARM指令：32位     ARM状态
2. Thumb指令：16位  Thumb状态

常用汇编器：汇编指令相同，但写汇编程序时用到一些辅助语句不一样

1. GNU汇编器：GNU组织开发，Linux系统移植时都是GNU汇编器

2. ARM汇编器：ARM公司开发，纯手工汇编时用ARM汇编器比较多（例如：STM32开发）

# 八、ARM 的基本数据类型

ARM 采用的是 32 位架构，其基本数据类型有以下 4 种：
（1）Byte：字节，8 位。
（2）HalfWord：半字，16 位（半字必须与 2 字节边界对齐）在2的整数倍位置开始存放一个半字
（3）Word：字，32 位（字必须与 4 字节边界对齐） 在4的整数倍位置开始存放一个字

（4）DoubleWord（Cortex-A 支持），双字，64 位（双字必须与 8 字节边界对齐）在8的整数倍位置开始存放一个双字

# 九、大小端字节序

整数在内存的放置方法：

1. Big-Endian：大端字节序，数值的低位放在高地址

2. Little-Endian：小端字节序，数值的低位放在低地址

Intel X86 CPU：小端

IBM PowerPC CPU：大端

ARM处理器：大小端可配置，默认为小端

# 十、安装keil4

安装专业软件的一些常见注意事项：

1. 很多开发类专业工具只认Intel的CPU，不认AMD的CPU，做开发的电脑CPU最好是Intel的
2. 很多专业工具软件是不认中文目录名的
3. 很多专业工具软件是不认中文的windows登录名（这些软件需要用用户目录）
4. 很多软件的安装需要管理员权限，因此建议以管理员身份去执行安装程序

安装keil

	1. 右键选择以管理员身份运行MDK412.exe
 	2. 默认安装

​	破解：

​	1. 以管理员身份运行keil

安装编译器

1. windows7：以管理员身份运行安装程序，默认安装 ，记住安装位置

2. windows10：选中安装程序-----右键属性-------兼容性 选择windows7  以管理员身份运行

   ​                        默认安装，记住安装位置

简单使用：

1. 新建项目   project--->new uVision Project---->选择项目所在目录，命名项目----->选择CPU  NXP-----LPC2131       空项目  
2. 设置编译器
3. 新建源码文件 
4. 将源码文件加入项目
5. 编写并保存源码文件
6. 编译

示例代码：

```assembly
.text
.globl _start
_start:
	MOV R0,#3
	MOV R1,#4
	ADD R2,R0,R1
	b .
.end
```

